# Few shot instance segmentation with Matching Network and Mask R-CNN
This is the implementation of **mm-rcnn**, a few-shot instance segmentation framework combining [Matching Networks](https://arxiv.org/abs/1606.04080) and [Mask RCNN](https://arxiv.org/abs/1703.06870). The framework is illustrated in the figure below.

<p align="center">
 <img src="figures/framework.jpg" width=80%>
</p>

## Current Implementation
- Mask head with class attention
- 5 way 3 shot
- Weight hash abandoned, use fc instead
- One fc layer after vgg output to learn matching vector
- VGG backbone using vgg16 without bn, adapted from keras (caffe1k version)
- ResNet backbone using resnet50 with bn, adapted from keras (caffe1k version)
- Caffe imagenet preprocessing, subtract mean only. convert RGB to BGR
- Support is generated by mask and crop

## TODO list
- [ ] Test on convergency with first 20 categories of COCO dataset

- [ ] Train on whole COCO dataset and beat Siamese RCNN

- [x] Detect method probably contains bugs. Test it someday.
